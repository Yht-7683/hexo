<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>持续集成工具jenkins | Hexo</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="转载 13、持续集成工具jenkins">
<meta property="og:type" content="article">
<meta property="og:title" content="持续集成工具jenkins">
<meta property="og:url" content="http://www.2333nmsl.ml/2020/09/14/%E8%BD%AC%E8%BD%BD%2013%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%B7%A5%E5%85%B7jenkins/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="转载 13、持续集成工具jenkins">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://images-cdn.shimo.im/737vd8eXqlQXQ34d/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/YmelRpypaccvrMrH/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/3b6FqXOzKrcVwbeI/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/YBpMwlwsPOsXbsgX/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/p63TOsQeH8Y1mEhs/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/kqghiXLI6E8MuSWe/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/NO68eFVOhVAZIDnm/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/vgryHTJFXaYceKDu/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/v9HGSdXQtWIefB2H/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/ilnAHgiUfLw9EtjT/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/CAe28rIy690lalvh/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/FiW7CM9XlaIgvpaF/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/IwxBZQ8YGN82fCrg/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/3CEjJga1gjcodKoq/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/Adnn9dv6Amoall7F/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/9wN9RLhN7mwldckM/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/iLxsNwO5RSMx6p3P/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/3QGDKxTcJcwFoRt5/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/oLMSkWX6YpcM6YZ0/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/bDKekdg9XZck8i7e/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/UGtFRnKb2yEKsDt1/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/8i0cRSO7EOQzck7Y/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/kg6FIMSZLbMk2GEF/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/V86jrVzTrY8SwM4w/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/ADu38UgvWQkizAeZ/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/jdRj8HDlY9gUOZyG/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/xtRo41Z9EaQnAWOg/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/FfPeify1fM46Fjp2/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/qHeyNv76nlQI1tqQ/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/Lit845DATbQjBiHH/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/jFn8PHADnH4DujCj/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/PftHCxZQNeMMl163/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/LNes0Dc1HnsmP0PJ/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/7X3VVA3SSKU1Rd4h/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/KgTYjmru1msjObuY/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/fORVH4i1198AtuWk/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/ulMEFxMiB1cPXgsj/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/JryUeNB6040m76CT/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/pVSLE1bIP1kCXoSH/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/AOuLZlZfPlwJoprY/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/nfScZO8HVBwSGjVE/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/A0DZqOOIeIIPZNjv/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/KuPjKGIUOx4pWEzL/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/MsMjNg8nSIoJn66F/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/MbWmhObtsgcqY6n8/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/RsWaxKasRjYkR0XQ/image.png!thumbnail">
<meta property="og:image" content="https://images-cdn.shimo.im/isiOHZvwzn4B8lZk/image.png!thumbnail">
<meta property="article:published_time" content="2020-09-14T15:00:04.000Z">
<meta property="article:modified_time" content="2020-09-14T07:07:17.956Z">
<meta property="article:author" content="yht">
<meta property="article:tag" content="jenkins">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images-cdn.shimo.im/737vd8eXqlQXQ34d/image.png!thumbnail">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 5.0.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/1.gif" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Yht-7683/" title="github">github</a>
					        
								<a class="mail" target="_blank" href="#" title="mail">mail</a>
					        
								<a class="qq" target="_blank" href="https://wpa.qq.com/msgrd?v=3&uin=434807683&site=qq&menu=yes" title="qq">qq</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/ASCII%E7%A0%81%E5%9B%BE/" style="font-size: 10px;">ASCII码图</a> <a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 20px;">Java基础</a> <a href="/tags/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 10px;">Java多线程</a> <a href="/tags/Redis/" style="font-size: 20px;">Redis</a> <a href="/tags/Websocket/" style="font-size: 10px;">Websocket</a> <a href="/tags/io/" style="font-size: 10px;">io</a> <a href="/tags/jenkins/" style="font-size: 10px;">jenkins</a> <a href="/tags/mybatis%E6%A1%86%E6%9E%B6/" style="font-size: 10px;">mybatis框架</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/renren-fast/" style="font-size: 15px;">renren-fast</a> <a href="/tags/spring-data/" style="font-size: 10px;">spring data</a> <a href="/tags/spring-security/" style="font-size: 10px;">spring security</a> <a href="/tags/springboot%E6%A1%86%E6%9E%B6/" style="font-size: 15px;">springboot框架</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 10px;">操作系统</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">数据库</a> <a href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" style="font-size: 10px;">消息队列</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">计算机网络</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://a-cai.gitee.io/blog/">前端资料</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/1.gif" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Yht-7683/" title="github">github</a>
			        
						<a class="mail" target="_blank" href="#" title="mail">mail</a>
			        
						<a class="qq" target="_blank" href="https://wpa.qq.com/msgrd?v=3&uin=434807683&site=qq&menu=yes" title="qq">qq</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-转载 13、持续集成工具jenkins" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/09/14/%E8%BD%AC%E8%BD%BD%2013%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%B7%A5%E5%85%B7jenkins/" class="article-date">
  	<time datetime="2020-09-14T15:00:04.000Z" itemprop="datePublished">2020-09-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      持续集成工具jenkins
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">jenkins</a></li></ul>
	</div>

        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/tHJoVGKfXjw43TZY.xmind">课程13预习_持续集成工具jenkins.xmind</a><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/cj0TWPCixFMdZaRP.xmind">1_持续集成工具jenkins.xmind</a><a target="_blank" rel="noopener" href="https://uploader.shimo.im/f/TYRmVrm7VD8t4Ykk.xmind">2_持续集成的概念.xmind</a>程序员开发应用，开发后需要提交svn，然后从svn拉取代码，进行构建，发布到tomcat中，发布，然后看呈现效果，这样的工作是频繁反复的在进行的，浪费了程序员的大量时间，那么能不能把这些工作自动化呢，只需要程序员更新代码到svn，然后自动的构建，发布，呈现效果，当然是可以的，通过jenkins来实现。</p>
<h2 id="什么是持续集成"><a href="#什么是持续集成" class="headerlink" title="什么是持续集成"></a>什么是持续集成</h2><p>互联网软件的开发和发布，已经形成了一套标准流程，最重要的组成部分就是持续集成（Continuous integration，简称CI）。</p>
<p>持续集成指的是，频繁地（一天多次）将代码集成到主干。</p>
<p>它的好处主要有两个。</p>
<p>（1）快速发现错误。每完成一点更新，就集成到主干，可以快速发现错误，定位错误也比较容易。</p>
<p>（2）防止分支大幅偏离主干。如果不是经常集成，主干又在不断更新，会导致以后集成的难度变大，甚至难以集成。</p>
<p>持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。</p>
<p>这种做法的核心思想在于：既然事实上难以做到事先完全了解完整的、正确的需求，那么就干脆一小块一小块的做，并且加快交付的速度和频率，使得交付物尽早在下个环节得到验证。早发现问题早返工。</p>
<p><strong>持续集成</strong></p>
<p><img src="https://images-cdn.shimo.im/737vd8eXqlQXQ34d/image.png!thumbnail" alt="图片"></p>
<p>持续集成强调开发人员提交了新代码之后，立刻进行构建、（单元）测试。根据测试结果，我们可以确定新代码和原有代码能否正确地集成在一起。</p>
<p><strong>持续交付</strong></p>
<p><img src="https://images-cdn.shimo.im/YmelRpypaccvrMrH/image.png!thumbnail" alt="图片"></p>
<p>持续交付在持续集成的基础上，将集成后的代码部署到更贴近真实运行环境的「类生产环境」（<em>production-like environments</em>）中。比如，我们完成单元测试后，可以把代码部署到连接数据库的 Staging 环境中更多的测试。如果代码没有问题，可以继续手动部署到生产环境中。</p>
<p><strong>持续部署</strong></p>
<p><img src="https://images-cdn.shimo.im/3b6FqXOzKrcVwbeI/image.png!thumbnail" alt="图片"></p>
<p>持续部署则是在持续交付的基础上，把部署到生产环境的过程自动化。</p>
<h3 id="总结就是"><a href="#总结就是" class="headerlink" title="总结就是"></a>总结就是</h3><p><strong>持续</strong>，就是说每完成一个完整的部分，就向下个环节交付，发现问题可以马上调整。是的问题不会放大到其他部分和后面的环节。</p>
<p><strong>集成，</strong>是指软件个人研发的部分向软件整体部分交付，以便尽早发现个人开发部分的问题；</p>
<p><strong>部署，</strong>是代码尽快向可运行的开发/测试节交付，以便尽早测试；</p>
<p><strong>交付，</strong>是指研发尽快向客户交付，以便尽早发现生产环境中存在的问题。</p>
<p>1）核心价值体现在：</p>
<p>a、持续集成中的任何一个环节都是自动完成的，无需太多的人工干预，有利于减少重复过程以节省时间、费用和工作量；</p>
<p>b、持续集成保障了每个时间点上团队成员提交的代码是能成功集成的。换言之，任何时间点都能第一时间发现软件的集成问题，使任意时间发布可部署的软件成为了可能；</p>
<p>c、持续集成还能利于软件本身的发展趋势，这点在需求不明确或是频繁性变更的情景中尤其重要，持续集成的质量能帮助团队进行有效决策，同时建立团队对开发产品的信心。</p>
<p>2）持续集成系统的组成</p>
<p>由此可见，一个完整的构建系统必须包括：</p>
<p>A、一个自动构建过程，包括自动编译、分发、部署和测试等。</p>
<p>B、 一个代码存储库，即需要版本控制软件来保障代码的可维护性，同时作为构建过程的素材库。</p>
<p>C、一个持续集成服务器。本文中介绍的 Jenkins/Jenkins 就是一个配置简单和使用方便的持续集成服务器。</p>
<h2 id="什么是jenkins"><a href="#什么是jenkins" class="headerlink" title="什么是jenkins"></a>什么是jenkins</h2><p>Jenkins是一个开源的持续集成的服务器，Jenkins开源帮助我们自动构建各类项目。Jenkins强大的插件式，使得Jenkins可以集成很多软件，可能帮助我们持续集成我们的工程项目。</p>
<p>Jenkins对于maven工程完整的编译和发布流程如下：</p>
<p>1、Jenkins从SVN上拉取代码到指定的编译机器上。</p>
<p>2、在编译机器上触发编译命令或脚本。</p>
<p>3、编译得到的结果文件。</p>
<p>4、把结果文件传到指定的服务器上。</p>
<p>5、重启服务</p>
<h2 id="jenkins环境安装"><a href="#jenkins环境安装" class="headerlink" title="jenkins环境安装"></a>jenkins环境安装</h2><h3 id="安装java环境"><a href="#安装java环境" class="headerlink" title="安装java环境"></a>安装java环境</h3><p>1、本地下载<strong>jdk8.tar.gz</strong>包，然后通过xshell和xftp工具上传到**/opt**【可自定义】目录。</p>
<p>2、使用<strong>tar -zxvf jdk8.tar.gz</strong>解压文件。</p>
<p>3、打开**/etc/profile**文件中配置java环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME&#x3D;&#x2F;opt&#x2F;jdk1.8.0_161</span><br><span class="line">export JRE_HOME&#x3D;$&#123;JAVA_HOME&#125;&#x2F;jre</span><br><span class="line">export CLASSPATH&#x3D;.:$&#123;JAVA_HOME&#125;&#x2F;lib:$&#123;JRE_HOME&#125;&#x2F;lib</span><br><span class="line">export PATH&#x3D;$&#123;JAVA_HOME&#125;&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>
<p>使用命令<strong>source /etc/profile</strong>让环境重新加载，输入<strong>java -version</strong>坚持是否配置成功<br><img src="https://images-cdn.shimo.im/YBpMwlwsPOsXbsgX/image.png!thumbnail" alt="图片"></p>
<h3 id="安装maven环境"><a href="#安装maven环境" class="headerlink" title="安装maven环境"></a>安装maven环境</h3><p>1、查看地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;maven.apache.org&#x2F;download.cgi</span><br></pre></td></tr></table></figure>
<p>2、复制要下载的链接地址，使用linux的wget命令下载。切换到**/opt**目录，直接下载：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;mirrors.hust.edu.cn&#x2F;apache&#x2F;maven&#x2F;maven-3&#x2F;3.5.3&#x2F;binaries&#x2F;apache-maven-3.5.3-bin.tar.gz</span><br></pre></td></tr></table></figure>
<p>3、使用<strong>tar -zxvf apache-maven-3.5.3-bin.tar.gz</strong>解压文件得到<strong>apache-maven-3.5.3</strong><br>4、**/etc/profile<strong>配置环境，并使用命令</strong>source /etc/profile**让环境重新加载</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export MAVEN_HOME&#x3D;&#x2F;opt&#x2F;apache-maven-3.5.3</span><br><span class="line">export PATH&#x3D;$&#123;MAVEN_HOME&#125;&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>
<p>5、检验是否配置成功。<br><img src="https://images-cdn.shimo.im/p63TOsQeH8Y1mEhs/image.png!thumbnail" alt="图片"></p>
<p>maven的配置setting.xml最好修改镜像源：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirror&gt;  </span><br><span class="line">   &lt;id&gt;alimaven&lt;&#x2F;id&gt;  </span><br><span class="line">   &lt;name&gt;aliyun maven&lt;&#x2F;name&gt;  </span><br><span class="line">   &lt;url&gt;http:&#x2F;&#x2F;maven.aliyun.com&#x2F;nexus&#x2F;content&#x2F;groups&#x2F;public&#x2F;&lt;&#x2F;url&gt;  </span><br><span class="line">   &lt;mirrorOf&gt;central&lt;&#x2F;mirrorOf&gt;          </span><br><span class="line"> &lt;&#x2F;mirror&gt;  </span><br></pre></td></tr></table></figure>
<h3 id="安装git环境"><a href="#安装git环境" class="headerlink" title="安装git环境"></a>安装git环境</h3><p>按照以下命名安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker</span><br><span class="line">wget https:&#x2F;&#x2F;www.kernel.org&#x2F;pub&#x2F;software&#x2F;scm&#x2F;git&#x2F;git-1.8.3.1.tar.gz</span><br><span class="line">tar xzf git-1.8.3.1.tar.gz</span><br><span class="line">cd git-1.8.3.1</span><br><span class="line">make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git all</span><br><span class="line">make prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;git install</span><br><span class="line">echo &quot;export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;git&#x2F;bin&quot; &gt;&gt;&#x2F;etc&#x2F;bashrc</span><br><span class="line">source &#x2F;etc&#x2F;bashrc</span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>
<h3 id="mysql安装"><a href="#mysql安装" class="headerlink" title="mysql安装"></a>mysql安装</h3><ul>
<li><a target="_blank" rel="noopener" href="http://www.runoob.com/mysql/mysql-install.html">http://www.runoob.com/mysql/mysql-install.html</a></li>
</ul>
<p>查看默认密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &#39;temporary password&#39; &#x2F;var&#x2F;log&#x2F;mysqld.log</span><br></pre></td></tr></table></figure>
<p><img src="https://images-cdn.shimo.im/kqghiXLI6E8MuSWe/image.png!thumbnail" alt="图片"></p>
<p>修改密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;admin&#39;;</span><br></pre></td></tr></table></figure>
<h2 id="安装jenkins"><a href="#安装jenkins" class="headerlink" title="安装jenkins"></a>安装jenkins</h2><h3 id="yum的安装方式"><a href="#yum的安装方式" class="headerlink" title="yum的安装方式"></a>yum的安装方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y java-1.8.0-openjdk &amp;&amp; \wget -O &#x2F;etc&#x2F;yum.repos.d&#x2F;jenkins.repo https:&#x2F;&#x2F;pkg.jenkins.io&#x2F;redhat&#x2F;jenkins.repo &amp;&amp; \rpm --import https:&#x2F;&#x2F;pkg.jenkins.io&#x2F;redhat&#x2F;jenkins.io.key &amp;&amp;\yum clean all &amp;&amp; yum makecache &amp;&amp; \yum install -y jenkins &amp;&amp; \systemctl start jenkins</span><br></pre></td></tr></table></figure>
<p>rpm -ql jenkins#查看jenkins安装相关目录<br>安装目录/var/lib/jenkins</p>
<p>配置文件 /etc/sysconfig/jenkins</p>
<p>日志目录 /var/log/jenkins</p>
<p>详细可见：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26848099/article/details/78901240">https://blog.csdn.net/qq_26848099/article/details/78901240</a></p>
<h3 id="下载jenkins-war"><a href="#下载jenkins-war" class="headerlink" title="下载jenkins.war"></a>下载jenkins.war</h3><p>直接下载war包，windows和linux环境通用。linux可以通过wget命令直接下载到指定目录。windows直接把链接复制到浏览器链接栏即可下载。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;mirrors.shu.edu.cn&#x2F;jenkins&#x2F;war-stable&#x2F;2.121.1&#x2F;jenkins.war</span><br></pre></td></tr></table></figure>
<p>下载完了之后可以在当前目录看到jenkins.war包，表示已经下载完成。<br>新版本看这里：<a target="_blank" rel="noopener" href="http://mirrors.jenkins-ci.org/war/latest/">http://mirrors.jenkins-ci.org/war/latest/</a></p>
<h3 id="运行命令"><a href="#运行命令" class="headerlink" title="运行命令"></a>运行命令</h3><p>jenkins.war包可以有两种运行方式：</p>
<ul>
<li>第一种是把war包放到tomcat的webapps目录下运行；</li>
<li>第二种是直接通过java -jar来启动项目，因为jenkins.war包里面已经内置了jetty服务器，可以直接启动，通过–httpPort来指定启动端口，添加&amp;表示以服务形式启动。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jenkins.war --httpPort&#x3D;8081 &amp;</span><br></pre></td></tr></table></figure>
<h3 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h3></li>
</ul>
<p>打开链接地址<a target="_blank" rel="noopener" href="http://你的ip/">http://你的ip</a>:8081,</p>
<p><img src="https://images-cdn.shimo.im/NO68eFVOhVAZIDnm/image.png!thumbnail" alt="图片"></p>
<p>获取秘钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;.jenkins&#x2F;secrets&#x2F;initialAdminPassword</span><br></pre></td></tr></table></figure>
<p>新手最好直接选择安装推荐的插件就可以，熟悉以后下次就可以自定义插件安装即可。<br><img src="https://images-cdn.shimo.im/vgryHTJFXaYceKDu/image.png!thumbnail" alt="图片"></p>
<p>正在下载推荐的额插件</p>
<p><img src="https://images-cdn.shimo.im/v9HGSdXQtWIefB2H/image.png!thumbnail" alt="图片"></p>
<p>插件安装完毕，跳转到创建管理员。填入用户名密码。</p>
<p><img src="https://images-cdn.shimo.im/ilnAHgiUfLw9EtjT/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/CAe28rIy690lalvh/image.png!thumbnail" alt="图片"></p>
<p>jenkins安装成功。</p>
<p><img src="https://images-cdn.shimo.im/FiW7CM9XlaIgvpaF/image.png!thumbnail" alt="图片"></p>
<h3 id="jenkins插件管理"><a href="#jenkins插件管理" class="headerlink" title="jenkins插件管理"></a>jenkins插件管理</h3><p>本次课程主要讲发布maven项目到tomcat中。所以还需要安装以下两个插件：</p>
<p>打开管理插件页面：</p>
<p><img src="https://images-cdn.shimo.im/IwxBZQ8YGN82fCrg/image.png!thumbnail" alt="图片"></p>
<ul>
<li>一个构建maven项目插件</li>
</ul>
<p><img src="https://images-cdn.shimo.im/3CEjJga1gjcodKoq/image.png!thumbnail" alt="图片"></p>
<ul>
<li>一个发布到tomcat的插件</li>
</ul>
<p><img src="https://images-cdn.shimo.im/Adnn9dv6Amoall7F/image.png!thumbnail" alt="图片"></p>
<p>选择，直接安装！</p>
<h3 id="jenkins全局配置"><a href="#jenkins全局配置" class="headerlink" title="jenkins全局配置"></a>jenkins全局配置</h3><p>系统管理–》全局工具配置，需要把服务器的jdk、maven、git等环境配置好。</p>
<p><img src="https://images-cdn.shimo.im/9wN9RLhN7mwldckM/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/iLxsNwO5RSMx6p3P/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/3QGDKxTcJcwFoRt5/image.png!thumbnail" alt="图片"></p>
<h2 id="构建jar项目"><a href="#构建jar项目" class="headerlink" title="构建jar项目"></a>构建jar项目</h2><h3 id="共同配置"><a href="#共同配置" class="headerlink" title="共同配置"></a>共同配置</h3><ul>
<li>新建一个maven项目。</li>
</ul>
<p><img src="https://images-cdn.shimo.im/oLMSkWX6YpcM6YZ0/image.png!thumbnail" alt="图片"></p>
<ul>
<li>配置git或者svn地址，jenkins会自动从远程仓库拉去最新代码。</li>
</ul>
<p><img src="https://images-cdn.shimo.im/bDKekdg9XZck8i7e/image.png!thumbnail" alt="图片"></p>
<p>如果是私有项目的话，需要加入用户名密码</p>
<p><img src="https://images-cdn.shimo.im/UGtFRnKb2yEKsDt1/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/8i0cRSO7EOQzck7Y/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/kg6FIMSZLbMk2GEF/image.png!thumbnail" alt="图片"></p>
<ul>
<li>开始maven打包构建的命令，可以去掉test测试<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clean install -Dmaven.test.skip&#x3D;true -Ptest</span><br></pre></td></tr></table></figure>
<img src="https://images-cdn.shimo.im/V86jrVzTrY8SwM4w/image.png!thumbnail" alt="图片"></li>
</ul>
<h3 id="jenkins与应用服务器同一台机器"><a href="#jenkins与应用服务器同一台机器" class="headerlink" title="jenkins与应用服务器同一台机器"></a>jenkins与应用服务器同一台机器</h3><ul>
<li>经过上一个步骤之后，jenkins会在默认路径/root/.jenkins/workspace/上看到打包的项目，/root/.jenkins/workspace/homework/target目录下有打包的jar文件。spring-boot-homework-0.0.1-SNAPSHOT.jar。因此我们打包完成之后的工作就是要替换原来的jar文件，然后重启项目。</li>
</ul>
<p><img src="https://images-cdn.shimo.im/ADu38UgvWQkizAeZ/image.png!thumbnail" alt="图片"></p>
<p>这里我们使用shell脚本来完成。</p>
<ol>
<li>DIR表示存放jar文件、和启动项目的文件夹。JAEFILE是指jar包的名称。</li>
<li>接下来的工作其实就是杀掉原来的spring-boot-homework-0.0.1-SNAPSHOT.jar进程</li>
<li>备份原来的jar包</li>
<li>把新生成的jar覆盖原来的</li>
<li>然后java -jar启动项目</li>
</ol>
<ul>
<li>BUILD_ID=dontKillMe表示jenkins不杀掉衍生的线程</li>
<li>nohup表示不用提示</li>
</ul>
<p>shell脚本如下：这个脚本有缺陷，只做测试使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;开始启动项目~~~~~~~~~&#39;</span><br><span class="line">DATE&#x3D;$(date +%Y%m%d_%H%M)</span><br><span class="line">export JAVA_HOME PATH CLASSPATH</span><br><span class="line">JAVA_HOME&#x3D;&#x2F;opt&#x2F;jdk1.8.0_181</span><br><span class="line">PATH&#x3D;$JAVA_HOME&#x2F;bin:$JAVA_HOME&#x2F;jre&#x2F;bin:$PATH</span><br><span class="line">CLASSPATH&#x3D;.:$JAVA_HOME&#x2F;lib:$JAVA_HOME&#x2F;jre&#x2F;lib:$CLASSPATH</span><br><span class="line">DIR&#x3D;&#x2F;opt&#x2F;jar</span><br><span class="line">JARFILE&#x3D;spring-boot-homework-0.0.1-SNAPSHOT.jar</span><br><span class="line">if [ ! -d $DIR&#x2F;backup ];then</span><br><span class="line">   mkdir -p $DIR&#x2F;backup</span><br><span class="line">fi</span><br><span class="line">cd $DIR</span><br><span class="line">ps -ef | grep $JARFILE | grep -v grep | awk &#39;&#123;print $2&#125;&#39; | xargs kill -9</span><br><span class="line">mv $JARFILE backup&#x2F;$JARFILE$DATE</span><br><span class="line">mv -f &#x2F;root&#x2F;.jenkins&#x2F;workspace&#x2F;homework&#x2F;target&#x2F;$JARFILE .</span><br><span class="line">BUILD_ID&#x3D;dontKillMe nohup java -jar $JARFILE &gt; out.log &amp;</span><br><span class="line">if [ $? &#x3D; 0 ];then</span><br><span class="line">        sleep 30</span><br><span class="line">        tail -n 50 out.log</span><br><span class="line">fi</span><br><span class="line">cd backup&#x2F;</span><br><span class="line">ls -lt|awk &#39;NR&gt;5&#123;print $NF&#125;&#39;|xargs rm -rf</span><br><span class="line">echo &#39;结束启动项目~~~~&#39;</span><br></pre></td></tr></table></figure>
<p>致此，项目就会自动部署，只需要点击构建按钮，jenkins就会自动拉去最新代码，然后备份、重启项目。<br>回顾一下流程：</p>
<ul>
<li>首先创建maven项目</li>
<li>配置项目的git仓库地址</li>
<li>配置maven构建命令（打包命令）</li>
<li>打包文成之后执行shell实现切换jar，重新部署项目。<h3 id="jenkins与应用服务器不同台机器"><a href="#jenkins与应用服务器不同台机器" class="headerlink" title="jenkins与应用服务器不同台机器"></a>jenkins与应用服务器不同台机器</h3></li>
</ul>
<p>上面的过程是当jenkins与应用服务器同一台的时候才能直接复制过去，当服务器不同的时候就不能这样做了，可以通过ssh或者scp来传输jar包过去，然后再执行shell脚本。</p>
<ul>
<li>配置ssh免密登录</li>
</ul>
<p>为了方便演示，我这里用的还是同一台机器，不过不再使用复制的方式，而是通过ssh吧文件传输给自己。</p>
<p>在配置之前，输入ssh 127.0.0.1，会提示要输入密码。</p>
<p><img src="https://images-cdn.shimo.im/jdRj8HDlY9gUOZyG/image.png!thumbnail" alt="图片"></p>
<p>ssh的配置可使用密钥，也可以使用密码，这里我们使用密钥来配置，在配置之前先配置好jenkins服务器和应用服务器的密钥认证。</p>
<p><strong>应用服务器</strong>上生成密钥对，使用ssh-keygen -t rsa命令。输入下面命令<strong>一直回车</strong>，一个矩形图形出现就说明成功，在~/.ssh/下会有私钥id_rsa和公钥id_rsa.pub</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p><img src="https://images-cdn.shimo.im/xtRo41Z9EaQnAWOg/image.png!thumbnail" alt="图片"></p>
<p><img src="https://images-cdn.shimo.im/FfPeify1fM46Fjp2/image.png!thumbnail" alt="图片"></p>
<p>然后把生成的公钥推动到jenkins服务器上，加入47.106.38.101是应用服务器的ip，因为这里用的jenkins和应用服务器同一台，所以ip是一样的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~&#x2F;.ssh&#x2F;id_rsa.pub 47.106.38.101</span><br></pre></td></tr></table></figure>
<p>第一次需要验证密码，输入应用服务器的登录免密。出现以下提示，说明成功了。<br><img src="https://images-cdn.shimo.im/qHeyNv76nlQI1tqQ/image.png!thumbnail" alt="图片"></p>
<p>在<strong>应用服务器</strong>上重启ssh服务，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart</span><br></pre></td></tr></table></figure>
<p>这时候再次ssh 47.106.38.101或者ssh 127.0.0.1就会直接登录成功，不再需要免密。<br><img src="https://images-cdn.shimo.im/Lit845DATbQjBiHH/image.png!thumbnail" alt="图片"></p>
<p>致此，免密登录配置完成~</p>
<p>总结一下上面的内容，就是应用服务器上配置密钥对，然后把公钥发送到jenkins服务器上，这样jenkins就有公钥可以加密连接到应用服务器了。</p>
<p>接下来的工作就是上次jar文件到应用服务器，然后执行shell实现重启应用。</p>
<p>这里使用一种比较简单的方法，直接替换之前的命令行就行。</p>
<p><img src="https://images-cdn.shimo.im/jFn8PHADnH4DujCj/image.png!thumbnail" alt="图片">命令行的意思是通过scp命令把jar上次到远程服务器的指定目录，然后通过ssh免密登录指定远程的脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd target&#x2F;</span><br><span class="line">scp spring-boot-homework-0.0.1-SNAPSHOT.jar 127.0.0.1:&#x2F;opt&#x2F;jar&#x2F;target&#x2F;</span><br><span class="line">ssh 127.0.0.1 &quot;cd &#x2F;opt&#x2F;jar;  .&#x2F;republish.sh;&quot;</span><br></pre></td></tr></table></figure>

<p>远程脚本如下：<strong>和之前的差不多，改了一下jar的目录而已</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DATE&#x3D;$(date +%Y%m%d_%H:%M:%S)</span><br><span class="line">export JAVA_HOME PATH CLASSPATH</span><br><span class="line">JAVA_HOME&#x3D;&#x2F;opt&#x2F;jdk1.8.0_181</span><br><span class="line">PATH&#x3D;$JAVA_HOME&#x2F;bin:$JAVA_HOME&#x2F;jre&#x2F;bin:$PATH</span><br><span class="line">CLASSPATH&#x3D;.:$JAVA_HOME&#x2F;lib:$JAVA_HOME&#x2F;jre&#x2F;lib:$CLASSPATH</span><br><span class="line">DIR&#x3D;&#x2F;opt&#x2F;jar</span><br><span class="line">JARFILE&#x3D;spring-boot-homework-0.0.1-SNAPSHOT.jar</span><br><span class="line">if [ ! -d $DIR&#x2F;backup ];then</span><br><span class="line">   mkdir -p $DIR&#x2F;backup</span><br><span class="line">fi</span><br><span class="line">cd $DIR</span><br><span class="line">ps -ef | grep $JARFILE | grep -v grep | awk &#39;&#123;print $2&#125;&#39; | xargs kill -9</span><br><span class="line">mv $JARFILE backup&#x2F;$JARFILE$DATE</span><br><span class="line">mv -f &#x2F;opt&#x2F;jar&#x2F;target&#x2F;$JARFILE .</span><br><span class="line">java -jar $JARFILE &gt; out.log &amp;</span><br><span class="line">if [ $? &#x3D; 0 ];then</span><br><span class="line">        sleep 30</span><br><span class="line">        tail -n 50 out.log</span><br><span class="line">fi</span><br><span class="line">cd backup&#x2F;</span><br><span class="line">ls -lt|awk &#39;NR&gt;5&#123;print $NF&#125;&#39;|xargs rm -rf</span><br></pre></td></tr></table></figure>

<p><strong><em>另一种方法，还没测试成功。（暂时放弃）———————————————————</em></strong></p>
<p>配置jenkins的ssh传输</p>
<p>首先安装publish over ssh插件</p>
<p><img src="https://images-cdn.shimo.im/PftHCxZQNeMMl163/image.png!thumbnail" alt="图片"></p>
<p>安装之后，点击系统管理 &gt; 系统设置</p>
<p>选择 Publish over SSH</p>
<ul>
<li>Passphrase 不用设置</li>
<li>Path to key 写上生成的ssh路径：/root/.ssh/id_rsa</li>
</ul>
<p>下面的SSH Servers是重点</p>
<ul>
<li>Name 随意起名代表这个服务，待会要根据它来选则</li>
<li>Hostname 配置应用服务器的地址</li>
<li>Username 配置linux登陆用户名</li>
<li>Remote Directory 不填</li>
</ul>
<p><img src="https://images-cdn.shimo.im/LNes0Dc1HnsmP0PJ/image.png!thumbnail" alt="图片"></p>
<p>点击test configuration之后，出现success，表示成功。</p>
<ul>
<li>新建一个maven构建项目home_server_split。复制之前的项目配置。</li>
</ul>
<p><img src="https://images-cdn.shimo.im/7X3VVA3SSKU1Rd4h/image.png!thumbnail" alt="图片"></p>
<p>大部分的配置都是和同一台机器的一样的，需要修改的地方是打包完成之后的操作。</p>
<p><img src="https://images-cdn.shimo.im/KgTYjmru1msjObuY/image.png!thumbnail" alt="图片"></p>
<ul>
<li>Source files配置:target/xxx-0.0.1-SNAPSHOT.jar 项目jar包名</li>
<li>Remove prefix:target/</li>
<li>Remote directory:代码应用服务器的目录地址，</li>
<li>Exec command： 应用服务器对应的脚本。</li>
</ul>
<p><strong><em>此种方法，还没测试成功。（暂时放弃）———————————————————</em></strong></p>
<h2 id="构建war项目（知道一下就行）"><a href="#构建war项目（知道一下就行）" class="headerlink" title="构建war项目（知道一下就行）"></a>构建war项目（知道一下就行）</h2><p>与发包jar项目的前面相同，不同的是打包构建之后的步骤不一样，之前是使用shell来完成项目的重新部署，现在打成war之后我们需要做的是替换原来的war包</p>
<p>springboot打包成war包请参考</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhoucheng05_13/article/details/77915294">https://blog.csdn.net/zhoucheng05_13/article/details/77915294</a><h3 id="tomcat设置容器账号密码"><a href="#tomcat设置容器账号密码" class="headerlink" title="tomcat设置容器账号密码"></a>tomcat设置容器账号密码</h3></li>
</ul>
<p>因为jenkins把项目打包成war包之后需要把项目发布到tomcat的webapp目录下运行，所以需要给tomcat这是发布的账号密码。</p>
<ul>
<li>tomcat7在<strong>conf/tomcat-users.xml</strong>下添加如下代码<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;role rolename&#x3D;&quot;tomcat&quot;&#x2F;&gt;</span><br><span class="line">&lt;role rolename&#x3D;&quot;manager-script&quot;&#x2F;&gt;</span><br><span class="line">&lt;role rolename&#x3D;&quot;manager&quot;&#x2F;&gt;</span><br><span class="line">  &lt;role rolename&#x3D;&quot;admin&quot;&#x2F;&gt;</span><br><span class="line">  &lt;role rolename&#x3D;&quot;admin-gui&quot;&#x2F;&gt;</span><br><span class="line">  &lt;role rolename&#x3D;&quot;manager-gui&quot;&#x2F;&gt;</span><br><span class="line">  &lt;user username&#x3D;&quot;admin&quot; password&#x3D;&quot;123456&quot; roles&#x3D;&quot;admin,admin-gui,manager-gui,manager-script,manager-gui&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure></li>
<li>tomcat8和tomcat9还需要在打开webapps/manager/META-INF/context.xml，把一行代码注释掉，如图：</li>
<li>参考：<a target="_blank" rel="noopener" href="https://my.oschina.net/xwzj/blog/900463">https://my.oschina.net/xwzj/blog/900463</a></li>
</ul>
<p><img src="https://images-cdn.shimo.im/fORVH4i1198AtuWk/image.png!thumbnail" alt="图片"></p>
<ul>
<li>WAR/EAR files:是war包的相对路径，如target/xxx.war</li>
<li>content path:Tomcat的发布路径,即项目的上下文，用于访问项目。如<a target="_blank" rel="noopener" href="http://localhost:8080/heo">http://localhost:8080/heo</a>，heo</li>
<li>即为content path。</li>
<li>contaners :发布到的容器，主要可发布到tomcat、jboss、GlassFish</li>
<li>deploy on failure：发生错误的时候是否发布到tomcat<h2 id="码云Hook自动构建"><a href="#码云Hook自动构建" class="headerlink" title="码云Hook自动构建"></a>码云Hook自动构建</h2></li>
</ul>
<ul>
<li><a target="_blank" rel="noopener" href="https://gitee.com/oschina/Gitee-Jenkins-Plugin">https://gitee.com/oschina/Gitee-Jenkins-Plugin</a></li>
</ul>
<p>这里要利用的其实是码云的webhook功能。</p>
<p><img src="https://images-cdn.shimo.im/ulMEFxMiB1cPXgsj/image.png!thumbnail" alt="图片"></p>
<ol>
<li><strong>首先jenkins安装gitee插件，实现自动部署插件</strong></li>
</ol>
<p><img src="https://images-cdn.shimo.im/JryUeNB6040m76CT/image.png!thumbnail" alt="图片"></p>
<ol>
<li><strong>添加码云链接配置</strong></li>
</ol>
<ul>
<li>前往 Jenkins -&gt; Manage Jenkins -&gt; Configure System -&gt; Gitee Configuration -&gt; Gitee connections</li>
<li>在 Connection name 中输入 Gitee 或者你想要的名字</li>
<li>Gitee host URL 中输入码云完整 URL地址：<a target="_blank" rel="noopener" href="https://gitee.com/">https://gitee.com</a>（码云私有化客户输入部署的域名）</li>
<li>Credentials 中如还未配置码云 APIV5 私人令牌，点击 Add - &gt; Jenkins<ul>
<li>Domain 选择 Global credentials</li>
<li>Kind 选择 Gitee API Token</li>
<li>Scope 选择你需要的范围</li>
<li>Gitee API Token 输入你的码云私人令牌，获取地址：<a target="_blank" rel="noopener" href="https://gitee.com/profile/personal_access_tokens">https://gitee.com/profile/personal_access_tokens</a></li>
</ul>
</li>
</ul>
<p><img src="https://images-cdn.shimo.im/pVSLE1bIP1kCXoSH/image.png!thumbnail" alt="图片"></p>
<p>生成的令牌：</p>
<p><img src="https://images-cdn.shimo.im/AOuLZlZfPlwJoprY/image.png!thumbnail" alt="图片"></p>
<pre><code>* ID, Descripiton 中输入你想要的 ID 和描述即可。</code></pre>
<p><img src="https://images-cdn.shimo.im/nfScZO8HVBwSGjVE/image.png!thumbnail" alt="图片"></p>
<ul>
<li>Credentials 选择配置好的 Gitee APIV5 Token</li>
<li>点击 Advanced ，可配置是否忽略 SSL 错误（适您的Jenkins环境是否支持），并可设置链接测超时时间（适您的网络环境而定）</li>
<li>点击 Test Connection 测试链接是否成功，如失败请检查以上 3，5，6 步骤。</li>
</ul>
<p>点击测试成功，标识gitee配置完成。</p>
<p><img src="https://images-cdn.shimo.im/A0DZqOOIeIIPZNjv/image.png!thumbnail" alt="图片"></p>
<p>配置了gitee的链接之后，接下来就是使用。</p>
<p>分为以下几个步骤：</p>
<p>1、打开x项目的配置，然后Gitee链接处。选择刚才配置的链接id</p>
<p><img src="https://images-cdn.shimo.im/KuPjKGIUOx4pWEzL/image.png!thumbnail" alt="图片"></p>
<p>2、配置构建触发器：</p>
<p><img src="https://images-cdn.shimo.im/MsMjNg8nSIoJn66F/image.png!thumbnail" alt="图片"></p>
<p>生成hook密码。</p>
<p><img src="https://images-cdn.shimo.im/MbWmhObtsgcqY6n8/image.png!thumbnail" alt="图片"></p>
<p>3、打开gitee上的项目，打开管理界面的webhooks。</p>
<p>url的配置需要注意一下，jenkins上建议的地址是<em>Gitee webhook 触发构建，需要在 Gitee webhook 中填写 URL:</em><a target="_blank" rel="noopener" href="http://47.106.38.101:8080/project/homework">http://47.106.38.101:8080/project/homework</a><em>。</em>但是我的jenkins端口其实是8081，所以需要改回来。然后把jenkins上生成的gitee webhook密码复制过来。</p>
<p><img src="https://images-cdn.shimo.im/RsWaxKasRjYkR0XQ/image.png!thumbnail" alt="图片"></p>
<p>点击测试，会发现，jenkins会自动开始构建完成项目发布了。也就是说，以后只要发布代码到git上，jenkins就会自动构建了，完成了自动化过程。</p>
<p><img src="https://images-cdn.shimo.im/isiOHZvwzn4B8lZk/image.png!thumbnail" alt="图片"></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/09/14/%E8%BD%AC%E8%BD%BD%2014%E3%80%81%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%B7%A5%E5%85%B7nginx/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          负载均衡工具nginx
        
      </div>
    </a>
  
  
    <a href="/2020/09/14/%E8%BD%AC%E8%BD%BD%2012%E3%80%81spring%20security%E4%B8%8Eoauth2/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">spring security与oauth2</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="转载 13、持续集成工具jenkins" data-title="持续集成工具jenkins" data-url="http://www.2333nmsl.ml/2020/09/14/%E8%BD%AC%E8%BD%BD%2013%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E5%B7%A5%E5%85%B7jenkins/"  data-images="/img/1.gif" data-content="持续集成工具jenkins">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2020 yht
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"rect":"opacity:0.8","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>